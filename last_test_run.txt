============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-8.3.5, pluggy-1.5.0
Using --randomly-seed=4124709075
rootdir: D:\SWARM\Dream.OS
configfile: pytest.ini
testpaths: tests
plugins: anyio-4.9.0, dash-3.0.2, Faker-37.1.0, pyfakefs-5.8.0, asyncio-0.26.0, cov-6.1.1, env-1.1.5, html-4.1.1, json-report-1.5.0, metadata-3.1.1, mock-3.14.1, randomly-3.16.0, repeat-0.9.4, rerunfailures-15.1, sugar-1.0.0, timeout-2.4.0, xdist-3.7.0
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=function, asyncio_default_test_loop_scope=function
collected 497 items

tests/voice/test_voicebot.py::test_disconnect PASSED                     [  0%]
tests/voice/test_voicebot.py::test_voice_queue_handler 
-------------------------------- live log call --------------------------------
2025-06-02 17:47:58 [    INFO] New audio file detected: C:\Users\USER\AppData\Local\Temp\pytest-of-USER\pytest-1179\test_voice_queue_handler0\voice_queue\test.mp3 (voicebot.py:41)
PASSED                                                                   [  0%]
tests/voice/test_voicebot.py::test_join_voice_channel 
-------------------------------- live log call --------------------------------
2025-06-02 17:47:58 [    INFO] Connected to voice channel: Test Channel (voicebot.py:138)
PASSED                                                                   [  0%]
tests/voice/test_voicebot.py::test_process_voice_queue PASSED            [  0%]
tests/core/test_init_mailbox.py::test_init_mailbox_invalid_directory PASSED [  1%]
tests/core/test_init_mailbox.py::test_mailbox_directory_cleanup PASSED   [  1%]
tests/core/test_init_mailbox.py::test_mailbox_file_corruption PASSED     [  1%]
tests/core/test_init_mailbox.py::test_mailbox_file_encoding PASSED       [  1%]
tests/core/test_init_mailbox.py::test_reset_mailbox_creates_backup PASSED [  1%]
tests/core/test_init_mailbox.py::test_mailbox_file_permissions PASSED    [  2%]
tests/core/test_init_mailbox.py::test_imports PASSED                     [  2%]
tests/core/test_init_mailbox.py::test_init_mailbox_invalid_agent_id PASSED [  2%]
tests/core/test_init_mailbox.py::test_init_mailbox_duplicate PASSED      [  2%]
tests/core/test_init_mailbox.py::test_init_mailbox_creates_files PASSED  [  2%]
tests/core/test_init_mailbox.py::test_init_mailbox_file_contents PASSED  [  3%]
tests/core/test_init_mailbox.py::test_reset_mailbox_restores_state PASSED [  3%]
tests/core/test_init_mailbox.py::test_reset_nonexistent_mailbox PASSED   [  3%]
tests/core/test_init_mailbox.py::test_get_initial_state PASSED           [  3%]
tests/core/test_init_mailbox.py::test_reset_mailbox_permission_error 
-------------------------------- live log call --------------------------------
2025-06-02 17:48:00 [ WARNING] Failed to create backup: Permission denied (init_mailbox.py:119)
PASSED                                                                   [  3%]
tests/core/test_init_mailbox.py::test_concurrent_mailbox_operations PASSED [  4%]
tests/auth/test_token.py::test_token_generation 
-------------------------------- live log call --------------------------------
2025-06-02 17:48:00 [    INFO] Generated token for user test_user with scope default (token.py:93)
PASSED                                                                   [  4%]
tests/auth/test_token.py::test_token_custom_scope 
-------------------------------- live log call --------------------------------
2025-06-02 17:48:01 [    INFO] Generated token for user test_user with scope admin (token.py:93)
PASSED                                                                   [  4%]
tests/auth/test_token.py::test_token_invalidation 
-------------------------------- live log call --------------------------------
2025-06-02 17:48:01 [    INFO] Generated token for user test_user with scope default (token.py:93)
2025-06-02 17:48:01 [    INFO] Token invalidated (token.py:164)
PASSED                                                                   [  4%]
tests/auth/test_token.py::test_token_refresh 
-------------------------------- live log call --------------------------------
2025-06-02 17:48:01 [    INFO] Generated token for user test_user with scope default (token.py:93)
2025-06-02 17:48:01 [    INFO] Generated token for user test_user with scope default (token.py:93)
2025-06-02 17:48:01 [    INFO] Refreshed token for user test_user (token.py:149)
PASSED                                                                   [  4%]
tests/auth/test_token.py::test_token_validation 
-------------------------------- live log call --------------------------------
2025-06-02 17:48:01 [    INFO] Generated token for user test_user with scope default (token.py:93)
PASSED                                                                   [  5%]
tests/auth/test_token.py::test_token_cleanup 
-------------------------------- live log call --------------------------------
2025-06-02 17:48:01 [    INFO] Generated token for user valid_user with scope default (token.py:93)
2025-06-02 17:48:01 [    INFO] Cleaned up 1 expired tokens (token.py:182)
PASSED                                                                   [  5%]
tests/auth/test_token.py::test_token_custom_data 
-------------------------------- live log call --------------------------------
2025-06-02 17:48:01 [    INFO] Generated token for user test_user with scope default (token.py:93)
PASSED                                                                   [  5%]
tests/auth/test_token.py::test_token_custom_ttl 
-------------------------------- live log call --------------------------------
2025-06-02 17:48:01 [    INFO] Generated token for user test_user with scope default (token.py:93)
PASSED                                                                   [  5%]
tests/auth/test_token.py::test_token_handler_initialization PASSED       [  5%]
tests/auth/test_token.py::test_token_info_creation PASSED                [  6%]
tests/auth/test_token.py::test_token_info_expiration PASSED              [  6%]
tests/social/core/test_log_manager.py::test_basic_logging FAILED         [  6%]
tests/social/core/test_log_manager.py::test_config_serialization ERROR   [  6%]
tests/social/core/test_log_manager.py::test_invalid_config FAILED        [  6%]

=================================== ERRORS ====================================
_________________ ERROR at setup of test_config_serialization _________________
file D:\SWARM\Dream.OS\tests\social\core\test_log_manager.py, line 224
  def test_config_serialization(log_config, temp_path):
E       fixture 'temp_path' not found
>       available fixtures: __pytest_repeat_step_number, _session_event_loop, _session_faker, agent_id, agent_operations, anyio_backend, anyio_backend_name, anyio_backend_options, bot, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, claim_test, class_mocker, clean_runtime_dir, clean_test_dirs, cov, dash_br, dash_duo, dash_duo_mp, dash_multi_process_server, dash_process_server, dash_thread_server, dashjl, dashjl_server, dashr, dashr_server, diskcache_manager, doctest_namespace, event_loop, event_loop_policy, extra, extras, faker, faker_seed, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, fs, fs_class, fs_module, fs_session, gui_test_env, include_metadata_in_junit_xml, json_metadata, log_config, log_manager, message_processor, metadata, mock_agent_config, mock_agent_registry, mock_compressed_log_file, mock_config, mock_dispatcher, mock_driver_manager, mock_log_data, mock_log_file, mock_old_log_file, mock_platform_strategy, mock_pyautogui, mock_rate_limiter, mock_redis, mock_redis_connection, mocker, module_mocker, monkeypatch, no_cover, package_mocker, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, release_test, session_mocker, setup_and_cleanup, setup_logging, setup_teardown, setup_test_dirs, setup_test_env, temp_config_dir, temp_dir, temp_log_dir, temp_runtime_dir, temp_voice_dir, test_analysis, test_analysis_file, test_data_dir, test_dirs, test_env, test_log_dir, test_messages, testrun_uid, tests/social/core/test_log_manager.py::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory, update_test_status, voice_queue, worker_id
>       use 'pytest --fixtures [testpath]' for help on them.

D:\SWARM\Dream.OS\tests\social\core\test_log_manager.py:224
----------------------------- Captured log setup ------------------------------
DEBUG    asyncio:proactor_events.py:633 Using proactor: IocpProactor
================================== FAILURES ===================================
_____________________________ test_basic_logging ______________________________
tests\social\core\test_log_manager.py:70: in test_basic_logging
    assert len(logs) == 3
E   assert 0 == 3
E    +  where 0 = len([])
---------------------------- Captured stdout setup ----------------------------
[LogManager] Setting log level: 10 (<class 'int'>)
-------------------------- Captured stderr teardown ---------------------------
2025-06-02 17:48:06 - discord.player - DEBUG - Preparing to terminate ffmpeg process 11380.
2025-06-02 17:48:06 - discord.player - INFO - ffmpeg process 11380 successfully terminated with return code of 3199971767.
_____________________________ test_invalid_config _____________________________
tests\social\core\test_log_manager.py:205: in test_invalid_config
    LogConfig(format="INVALID")
E   TypeError: LogConfig.__init__() got an unexpected keyword argument 'format'
----------------------------- Captured log setup ------------------------------
DEBUG    asyncio:proactor_events.py:633 Using proactor: IocpProactor
---------------------------- Captured log teardown ----------------------------
DEBUG    asyncio:proactor_events.py:633 Using proactor: IocpProactor
=========================== short test summary info ===========================
FAILED tests/social/core/test_log_manager.py::test_basic_logging - assert 0 == 3
FAILED tests/social/core/test_log_manager.py::test_invalid_config - TypeError...
ERROR tests/social/core/test_log_manager.py::test_config_serialization
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 3 failures !!!!!!!!!!!!!!!!!!!!!!!!!!
============= 2 failed, 31 passed, 6 warnings, 1 error in 12.34s ==============
